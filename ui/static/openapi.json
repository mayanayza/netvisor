{
  "openapi": "3.1.0",
  "info": {
    "title": "Scanopy API",
    "description": "Network topology discovery and visualization API",
    "license": {
      "name": "Dual (AGPL3.0, Commercial License Available)"
    },
    "version": "0.12.5"
  },
  "paths": {
    "/api/auth/keys": {
      "get": {
        "tags": [
          "api_keys"
        ],
        "summary": "List all api_keys",
        "operationId": "list_api_keys",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of api_keys",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ApiKey"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "api_keys"
        ],
        "summary": "Create API key",
        "operationId": "create_api_key",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApiKey"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "API key created"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/auth/keys/bulk-delete": {
      "post": {
        "tags": [
          "api_keys"
        ],
        "summary": "Bulk delete api_keys",
        "operationId": "bulk_delete_api_keys",
        "requestBody": {
          "description": "Array of api_keys IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "ApiKeys deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/auth/keys/{id}": {
      "get": {
        "tags": [
          "api_keys"
        ],
        "summary": "Get api_key by ID",
        "operationId": "get_api_key_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "ApiKey ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "ApiKey found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiKey"
                }
              }
            }
          },
          "404": {
            "description": "ApiKey not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "api_keys"
        ],
        "summary": "Update an API key",
        "operationId": "update_api_key",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ApiKey"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "API key updated"
          },
          "404": {
            "description": "API key not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "api_keys"
        ],
        "summary": "Delete api_key",
        "operationId": "delete_api_key",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "ApiKey ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "ApiKey deleted"
          },
          "404": {
            "description": "ApiKey not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/auth/keys/{id}/rotate": {
      "post": {
        "tags": [
          "api_keys"
        ],
        "summary": "Rotate an API key",
        "operationId": "rotate_key_handler",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "API key ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "API key rotated, returns new key"
          },
          "404": {
            "description": "API key not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/bindings": {
      "get": {
        "tags": [
          "bindings"
        ],
        "summary": "List all bindings",
        "operationId": "list_bindings",
        "parameters": [
          {
            "name": "service_id",
            "in": "query",
            "description": "Filter by service ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "port_id",
            "in": "query",
            "description": "Filter by port ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "interface_id",
            "in": "query",
            "description": "Filter by interface ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of bindings",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Binding"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "bindings"
        ],
        "summary": "Create new binding",
        "operationId": "create_binding",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Binding"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Binding created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Binding"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/bindings/bulk-delete": {
      "post": {
        "tags": [
          "bindings"
        ],
        "summary": "Bulk delete bindings",
        "operationId": "bulk_delete_bindings",
        "requestBody": {
          "description": "Array of bindings IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Bindings deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/bindings/{id}": {
      "get": {
        "tags": [
          "bindings"
        ],
        "summary": "Get binding by ID",
        "operationId": "get_binding_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Binding found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Binding"
                }
              }
            }
          },
          "404": {
            "description": "Binding not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "bindings"
        ],
        "summary": "Update binding",
        "operationId": "update_binding",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Binding"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Binding updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Binding"
                }
              }
            }
          },
          "404": {
            "description": "Binding not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "bindings"
        ],
        "summary": "Delete binding",
        "operationId": "delete_binding",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Binding ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Binding deleted"
          },
          "404": {
            "description": "Binding not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/daemons": {
      "get": {
        "tags": [
          "daemons"
        ],
        "summary": "List all daemons",
        "operationId": "list_daemons",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of daemons",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Daemon"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/daemons/bulk-delete": {
      "post": {
        "tags": [
          "daemons"
        ],
        "summary": "Bulk delete daemons",
        "operationId": "bulk_delete_daemons",
        "requestBody": {
          "description": "Array of daemons IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Daemons deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/daemons/{id}": {
      "get": {
        "tags": [
          "daemons"
        ],
        "summary": "Get daemon by ID",
        "operationId": "get_daemon_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Daemon ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Daemon found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Daemon"
                }
              }
            }
          },
          "404": {
            "description": "Daemon not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "daemons"
        ],
        "summary": "Update daemon",
        "operationId": "update_daemon",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Daemon ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Daemon"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Daemon updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Daemon"
                }
              }
            }
          },
          "404": {
            "description": "Daemon not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "daemons"
        ],
        "summary": "Delete daemon",
        "operationId": "delete_daemon",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Daemon ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Daemon deleted"
          },
          "404": {
            "description": "Daemon not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery": {
      "get": {
        "tags": [
          "discoveries"
        ],
        "summary": "List all discoveries",
        "operationId": "list_discoveries",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "daemon_id",
            "in": "query",
            "description": "Filter by daemon ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of discoveries",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Discovery"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Create a new discovery",
        "operationId": "create_discovery",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Discovery"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discovery created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Discovery"
                }
              }
            }
          },
          "400": {
            "description": "Invalid subnet network"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/active-sessions": {
      "get": {
        "tags": [
          "discoveries"
        ],
        "summary": "Get active discovery sessions",
        "operationId": "get_active_sessions",
        "responses": {
          "200": {
            "description": "List of active discovery sessions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/DiscoveryUpdatePayload"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/bulk-delete": {
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Bulk delete discoveries",
        "operationId": "bulk_delete_discoveries",
        "requestBody": {
          "description": "Array of discoveries IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discoverys deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/start-session": {
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Start a discovery session",
        "operationId": "start_session",
        "requestBody": {
          "content": {
            "text/plain": {
              "schema": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discovery session started",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DiscoveryUpdatePayload"
                }
              }
            }
          },
          "404": {
            "description": "Discovery not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/{id}": {
      "get": {
        "tags": [
          "discoveries"
        ],
        "summary": "Get discovery by ID",
        "operationId": "get_discovery_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Discovery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Discovery"
                }
              }
            }
          },
          "404": {
            "description": "Discovery not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "discoveries"
        ],
        "summary": "Update discovery",
        "operationId": "update_discovery",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Discovery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Discovery"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Discovery updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Discovery"
                }
              }
            }
          },
          "404": {
            "description": "Discovery not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "discoveries"
        ],
        "summary": "Delete discovery",
        "operationId": "delete_discovery",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Discovery ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery deleted"
          },
          "404": {
            "description": "Discovery not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/discovery/{session_id}/cancel": {
      "post": {
        "tags": [
          "discoveries"
        ],
        "summary": "Cancel a discovery session",
        "operationId": "cancel_discovery",
        "parameters": [
          {
            "name": "session_id",
            "in": "path",
            "description": "Session ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Discovery session cancelled"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/groups": {
      "get": {
        "tags": [
          "groups"
        ],
        "summary": "List all groups",
        "operationId": "list_groups",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of groups",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Group"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "groups"
        ],
        "summary": "Create a new group",
        "operationId": "create_group",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Group"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Group created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Group"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/groups/bulk-delete": {
      "post": {
        "tags": [
          "groups"
        ],
        "summary": "Bulk delete groups",
        "operationId": "bulk_delete_groups",
        "requestBody": {
          "description": "Array of groups IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Groups deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/groups/{id}": {
      "get": {
        "tags": [
          "groups"
        ],
        "summary": "Get group by ID",
        "operationId": "get_group_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Group found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Group"
                }
              }
            }
          },
          "404": {
            "description": "Group not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "groups"
        ],
        "summary": "Update group",
        "operationId": "update_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Group"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Group updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Group"
                }
              }
            }
          },
          "404": {
            "description": "Group not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "groups"
        ],
        "summary": "Delete group",
        "operationId": "delete_group",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Group ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Group deleted"
          },
          "404": {
            "description": "Group not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/hosts": {
      "get": {
        "tags": [
          "hosts"
        ],
        "summary": "List all hosts",
        "description": "Returns all hosts the authenticated user has access to, with their\ninterfaces, ports, and services included.",
        "operationId": "get_all_hosts",
        "responses": {
          "200": {
            "description": "List of hosts with their children",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/HostResponse"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "hosts"
        ],
        "summary": "Create a new host",
        "description": "Creates a host with optional interfaces, ports, and services.\nThe `source` field is automatically set to `Manual`.\nIDs for the host and all children are generated server-side.",
        "operationId": "create_host",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateHostRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Host created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - network not found or subnet mismatch"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/hosts/bulk-delete": {
      "post": {
        "tags": [
          "hosts"
        ],
        "summary": "Bulk delete hosts",
        "description": "Deletes multiple hosts in a single request. The request body should be\nan array of host IDs to delete. Fails if any host has an associated daemon.",
        "operationId": "bulk_delete_hosts",
        "requestBody": {
          "description": "Array of host IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Hosts deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          },
          "409": {
            "description": "One or more hosts has an associated daemon - delete daemons first"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/hosts/{destination_host}/consolidate/{other_host}": {
      "put": {
        "tags": [
          "hosts"
        ],
        "summary": "Consolidate hosts",
        "description": "Merges all interfaces, ports, and services from `other_host` into\n`destination_host`, then deletes `other_host`. Both hosts must be\non the same network.",
        "operationId": "consolidate_hosts",
        "parameters": [
          {
            "name": "destination_host",
            "in": "path",
            "description": "Destination host ID - will receive all children",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "other_host",
            "in": "path",
            "description": "Host to merge into destination - will be deleted",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Hosts consolidated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostResponse"
                }
              }
            }
          },
          "400": {
            "description": "Hosts are on different networks"
          },
          "404": {
            "description": "One or both hosts not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/hosts/{id}": {
      "get": {
        "tags": [
          "hosts"
        ],
        "summary": "Get a host by ID",
        "description": "Returns a single host with its interfaces, ports, and services.",
        "operationId": "get_host_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Host ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Host found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostResponse"
                }
              }
            }
          },
          "404": {
            "description": "Host not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "hosts"
        ],
        "summary": "Update a host",
        "description": "Updates host properties. Children (interfaces, ports, services)\nare managed via their own endpoints.",
        "operationId": "update_host",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Host ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateHostRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Host updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostResponse"
                }
              }
            }
          },
          "404": {
            "description": "Host not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "hosts"
        ],
        "summary": "Delete a host",
        "description": "Prevents deletion if the host has a daemon associated with it",
        "operationId": "delete_host",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Host ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Host deleted"
          },
          "404": {
            "description": "Host not found"
          },
          "409": {
            "description": "Host has associated daemon"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/interfaces": {
      "get": {
        "tags": [
          "interfaces"
        ],
        "summary": "List all interfaces",
        "operationId": "list_interfaces",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "subnet_id",
            "in": "query",
            "description": "Filter by subnet ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of interfaces",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Interface"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "interfaces"
        ],
        "summary": "Create new interface",
        "operationId": "create_interface",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Interface"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Interface created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Interface"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/interfaces/bulk-delete": {
      "post": {
        "tags": [
          "interfaces"
        ],
        "summary": "Bulk delete interfaces",
        "operationId": "bulk_delete_interfaces",
        "requestBody": {
          "description": "Array of interfaces IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Interfaces deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/interfaces/{id}": {
      "get": {
        "tags": [
          "interfaces"
        ],
        "summary": "Get interface by ID",
        "operationId": "get_interface_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Interface ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Interface found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Interface"
                }
              }
            }
          },
          "404": {
            "description": "Interface not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "interfaces"
        ],
        "summary": "Update interface",
        "operationId": "update_interface",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Interface ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Interface"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Interface updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Interface"
                }
              }
            }
          },
          "404": {
            "description": "Interface not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "interfaces"
        ],
        "summary": "Delete interface",
        "operationId": "delete_interface",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Interface ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Interface deleted"
          },
          "404": {
            "description": "Interface not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/invites": {
      "get": {
        "tags": [
          "invites"
        ],
        "summary": "List all invites for organization",
        "operationId": "get_invites",
        "responses": {
          "200": {
            "description": "List of active invites",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Invite"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "invites"
        ],
        "summary": "Create an organization invite",
        "operationId": "create_invite",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateInviteRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Invite created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Invite"
                }
              }
            }
          },
          "400": {
            "description": "User already has an account"
          },
          "403": {
            "description": "Seat limit reached or insufficient permissions"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/invites/{id}": {
      "get": {
        "tags": [
          "invites"
        ],
        "summary": "Get an invite by ID",
        "operationId": "get_invite",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Invite ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Invite details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Invite"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired invite"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/invites/{id}/revoke": {
      "delete": {
        "tags": [
          "invites"
        ],
        "summary": "Revoke an invite",
        "operationId": "revoke_invite",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Invite ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Invite revoked"
          },
          "400": {
            "description": "Invalid invite"
          },
          "403": {
            "description": "Cannot revoke this invite"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/networks": {
      "get": {
        "tags": [
          "networks"
        ],
        "summary": "List all networks",
        "operationId": "get_all_networks",
        "responses": {
          "200": {
            "description": "List of networks",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Network"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "networks"
        ],
        "summary": "Create a new network",
        "operationId": "create_network",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateNetworkRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Network created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Network"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          },
          "403": {
            "description": "Feature not available or not admin"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/networks/bulk-delete": {
      "post": {
        "tags": [
          "networks"
        ],
        "summary": "Bulk delete networks",
        "operationId": "bulk_delete_networks",
        "requestBody": {
          "description": "Array of network IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Networks deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/networks/{id}": {
      "get": {
        "tags": [
          "networks"
        ],
        "summary": "Get a network by ID",
        "operationId": "get_network_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Network ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Network found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Network"
                }
              }
            }
          },
          "404": {
            "description": "Network not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "networks"
        ],
        "summary": "Update a network",
        "operationId": "update_network",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Network ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Network"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Network updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Network"
                }
              }
            }
          },
          "404": {
            "description": "Network not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "networks"
        ],
        "summary": "Delete a network",
        "operationId": "delete_network",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Network ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Network deleted"
          },
          "404": {
            "description": "Network not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/organizations/{id}": {
      "put": {
        "tags": [
          "organizations"
        ],
        "summary": "Update organization name",
        "operationId": "update_org_name",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Organization ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "text/plain": {
              "schema": {
                "type": "string"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Organization updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Organization"
                }
              }
            }
          },
          "403": {
            "description": "Only owners can update organization"
          },
          "404": {
            "description": "Organization not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/ports": {
      "get": {
        "tags": [
          "ports"
        ],
        "summary": "List all ports",
        "operationId": "list_ports",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of ports",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Port"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "ports"
        ],
        "summary": "Create new port",
        "operationId": "create_port",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Port"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Port created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Port"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/ports/bulk-delete": {
      "post": {
        "tags": [
          "ports"
        ],
        "summary": "Bulk delete ports",
        "operationId": "bulk_delete_ports",
        "requestBody": {
          "description": "Array of ports IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Ports deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/ports/{id}": {
      "get": {
        "tags": [
          "ports"
        ],
        "summary": "Get port by ID",
        "operationId": "get_port_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Port ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Port found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Port"
                }
              }
            }
          },
          "404": {
            "description": "Port not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "ports"
        ],
        "summary": "Update port",
        "operationId": "update_port",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Port ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Port"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Port updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Port"
                }
              }
            }
          },
          "404": {
            "description": "Port not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "ports"
        ],
        "summary": "Delete port",
        "operationId": "delete_port",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Port ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Port deleted"
          },
          "404": {
            "description": "Port not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/services": {
      "get": {
        "tags": [
          "services"
        ],
        "summary": "List all services",
        "operationId": "list_services",
        "parameters": [
          {
            "name": "host_id",
            "in": "query",
            "description": "Filter by host ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          },
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of services",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Service"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "services"
        ],
        "summary": "Create a new service",
        "operationId": "create_service",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Service"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Service"
                }
              }
            }
          },
          "400": {
            "description": "Host network mismatch"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/services/bulk-delete": {
      "post": {
        "tags": [
          "services"
        ],
        "summary": "Bulk delete services",
        "operationId": "bulk_delete_services",
        "requestBody": {
          "description": "Array of services IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Services deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/services/{id}": {
      "get": {
        "tags": [
          "services"
        ],
        "summary": "Get service by ID",
        "operationId": "get_service_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Service found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Service"
                }
              }
            }
          },
          "404": {
            "description": "Service not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "services"
        ],
        "summary": "Update a service",
        "operationId": "update_service",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Service"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Service updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Service"
                }
              }
            }
          },
          "400": {
            "description": "Host network mismatch"
          },
          "404": {
            "description": "Service not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "services"
        ],
        "summary": "Delete service",
        "operationId": "delete_service",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Service ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Service deleted"
          },
          "404": {
            "description": "Service not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/subnets": {
      "get": {
        "tags": [
          "subnets"
        ],
        "summary": "List all subnets",
        "operationId": "list_subnets",
        "parameters": [
          {
            "name": "network_id",
            "in": "query",
            "description": "Filter by network ID",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ],
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of subnets",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Subnet"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "subnets"
        ],
        "summary": "Create a new subnet",
        "operationId": "create_subnet",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Subnet"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subnet created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Subnet"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/subnets/bulk-delete": {
      "post": {
        "tags": [
          "subnets"
        ],
        "summary": "Bulk delete subnets",
        "operationId": "bulk_delete_subnets",
        "requestBody": {
          "description": "Array of subnets IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subnets deleted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/subnets/{id}": {
      "get": {
        "tags": [
          "subnets"
        ],
        "summary": "Get subnet by ID",
        "operationId": "get_subnet_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subnet ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Subnet found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Subnet"
                }
              }
            }
          },
          "404": {
            "description": "Subnet not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "subnets"
        ],
        "summary": "Update subnet",
        "operationId": "update_subnet",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subnet ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Subnet"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Subnet updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Subnet"
                }
              }
            }
          },
          "404": {
            "description": "Subnet not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "subnets"
        ],
        "summary": "Delete subnet",
        "operationId": "delete_subnet",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Subnet ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Subnet deleted"
          },
          "404": {
            "description": "Subnet not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/tags": {
      "get": {
        "tags": [
          "tags"
        ],
        "summary": "List all tags",
        "operationId": "get_all_tags",
        "responses": {
          "200": {
            "description": "List of tags",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Tag"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "post": {
        "tags": [
          "tags"
        ],
        "summary": "Create a new tag",
        "operationId": "create_tag",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tag"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tag created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Tag"
                }
              }
            }
          },
          "409": {
            "description": "Tag name already exists"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/tags/bulk-delete": {
      "post": {
        "tags": [
          "tags"
        ],
        "summary": "Bulk delete tags",
        "operationId": "bulk_delete_tags",
        "requestBody": {
          "description": "Array of tag IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tags deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/tags/{id}": {
      "get": {
        "tags": [
          "tags"
        ],
        "summary": "Get a tag by ID",
        "operationId": "get_tag_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Tag"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "put": {
        "tags": [
          "tags"
        ],
        "summary": "Update a tag",
        "operationId": "update_tag",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tag"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tag updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Tag"
                }
              }
            }
          },
          "404": {
            "description": "Tag not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "tags"
        ],
        "summary": "Delete a tag",
        "operationId": "delete_tag",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Tag ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tag deleted"
          },
          "404": {
            "description": "Tag not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/users": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "List all users",
        "description": "Returns a list of users with permissions below the permissions of the user making the request.",
        "operationId": "get_all_users",
        "responses": {
          "200": {
            "description": "List of users",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/User"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/users/bulk-delete": {
      "post": {
        "tags": [
          "users"
        ],
        "summary": "Bulk delete users",
        "operationId": "bulk_delete_users",
        "requestBody": {
          "description": "Array of user IDs to delete",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Users deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BulkDeleteResponse"
                }
              }
            }
          },
          "403": {
            "description": "Cannot delete users with higher permissions"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    },
    "/api/users/{id}": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "Get user by ID",
        "operationId": "get_user_by_id",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      },
      "delete": {
        "tags": [
          "users"
        ],
        "summary": "Delete a user",
        "operationId": "delete_user",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "User ID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User deleted"
          },
          "403": {
            "description": "Cannot delete user with higher permissions"
          },
          "404": {
            "description": "User not found"
          },
          "409": {
            "description": "Cannot delete the only owner"
          }
        },
        "security": [
          {
            "session": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "ApiKey": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ApiKeyBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "ApiKeyBase": {
        "type": "object",
        "required": [
          "key",
          "name",
          "network_id"
        ],
        "properties": {
          "expires_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "is_enabled": {
            "type": "boolean"
          },
          "key": {
            "type": "string"
          },
          "last_used": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "readOnly": true
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "BillingPlan": {
        "oneOf": [
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Community"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Starter"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Pro"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Team"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Business"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Enterprise"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "Demo"
                    ]
                  }
                }
              }
            ]
          },
          {
            "allOf": [
              {
                "$ref": "#/components/schemas/PlanConfig"
              },
              {
                "type": "object",
                "required": [
                  "type"
                ],
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "CommercialSelfHosted"
                    ]
                  }
                }
              }
            ]
          }
        ]
      },
      "BillingRate": {
        "type": "string",
        "enum": [
          "Month",
          "Year"
        ]
      },
      "Binding": {
        "allOf": [
          {
            "$ref": "#/components/schemas/BindingBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "description": "Association between a service and a port / interface that the service is listening on",
        "example": {
          "created_at": "2025-12-24T04:33:16.078715Z",
          "id": "0fe99606-811a-491b-88b3-43b2d46ed682",
          "interface_id": "550e8400-e29b-41d4-a716-446655440005",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "port_id": "550e8400-e29b-41d4-a716-446655440006",
          "service_id": "550e8400-e29b-41d4-a716-446655440007",
          "type": "Port",
          "updated_at": "2025-12-24T04:33:16.078715Z"
        }
      },
      "BindingBase": {
        "allOf": [
          {
            "$ref": "#/components/schemas/BindingType"
          },
          {
            "type": "object",
            "required": [
              "service_id",
              "network_id"
            ],
            "properties": {
              "network_id": {
                "type": "string",
                "format": "uuid"
              },
              "service_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ],
        "description": "The base data for a Binding entity (everything except id, created_at, updated_at)"
      },
      "BindingType": {
        "oneOf": [
          {
            "type": "object",
            "title": "Interface",
            "required": [
              "interface_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Interface"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Port",
            "required": [
              "port_id",
              "type"
            ],
            "properties": {
              "interface_id": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "uuid",
                "description": "None = service is listening on this port on all interfaces"
              },
              "port_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Port"
                ]
              }
            }
          }
        ],
        "description": "The type of binding - either to an interface or to a port"
      },
      "BulkDeleteResponse": {
        "type": "object",
        "required": [
          "deleted_count",
          "requested_count"
        ],
        "properties": {
          "deleted_count": {
            "type": "integer",
            "minimum": 0
          },
          "requested_count": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "CreateHostRequest": {
        "type": "object",
        "description": "Request type for creating a host with its associated interfaces and ports.\nServer assigns `host_id`, `network_id`, and `source` to all children.\nSource is automatically set based on how the entity was created (API vs UI).\n\nNote: Services are created separately via `POST /api/services` after the host exists,\nas service bindings require the real IDs of the interfaces/ports to reference.",
        "required": [
          "name",
          "network_id"
        ],
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateInterfaceInput"
            }
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreatePortInput"
            }
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        },
        "example": {
          "description": "Primary web server",
          "hidden": false,
          "hostname": "web-server-01.local",
          "interfaces": [
            {
              "ip_address": "192.168.1.100",
              "mac_address": "DE:AD:BE:EF:12:34",
              "name": "eth0",
              "subnet_id": "550e8400-e29b-41d4-a716-446655440004"
            }
          ],
          "name": "web-server-01",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "ports": [
            {
              "number": 80,
              "protocol": "Tcp"
            }
          ],
          "tags": [],
          "virtualization": null
        }
      },
      "CreateInterfaceInput": {
        "type": "object",
        "description": "Input for creating an interface with a host.\n`host_id` and `network_id` are assigned by the server.",
        "required": [
          "subnet_id",
          "ip_address"
        ],
        "properties": {
          "ip_address": {
            "type": "string"
          },
          "mac_address": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "subnet_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "CreateInviteRequest": {
        "type": "object",
        "required": [
          "permissions",
          "network_ids"
        ],
        "properties": {
          "expiration_hours": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "send_to": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "CreateNetworkRequest": {
        "type": "object",
        "required": [
          "network",
          "seed_baseline_data"
        ],
        "properties": {
          "network": {
            "$ref": "#/components/schemas/Network"
          },
          "seed_baseline_data": {
            "type": "boolean",
            "description": "Whether to seed baseline data (default subnets, etc.) for the network"
          }
        }
      },
      "CreatePortInput": {
        "type": "object",
        "description": "Input for creating a port with a host.\n`host_id` and `network_id` are assigned by the server.\nThe port is specified by number and protocol (e.g., 80/tcp, 443/tcp).",
        "required": [
          "number",
          "protocol"
        ],
        "properties": {
          "number": {
            "type": "integer",
            "format": "int32",
            "description": "Port number (1-65535)",
            "minimum": 0
          },
          "protocol": {
            "$ref": "#/components/schemas/TransportProtocol",
            "description": "Transport protocol (Tcp or Udp)"
          }
        }
      },
      "Daemon": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DaemonBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "DaemonBase": {
        "type": "object",
        "required": [
          "host_id",
          "network_id",
          "url",
          "mode",
          "name"
        ],
        "properties": {
          "capabilities": {
            "$ref": "#/components/schemas/DaemonCapabilities"
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "last_seen": {
            "type": "string",
            "format": "date-time",
            "readOnly": true
          },
          "mode": {
            "$ref": "#/components/schemas/DaemonMode"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "url": {
            "type": "string",
            "readOnly": true
          }
        }
      },
      "DaemonCapabilities": {
        "type": "object",
        "description": "Daemon capabilities",
        "properties": {
          "has_docker_socket": {
            "type": "boolean"
          },
          "interfaced_subnet_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "DaemonMode": {
        "type": "string",
        "enum": [
          "Push",
          "Pull"
        ]
      },
      "Discovery": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DiscoveryBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "DiscoveryBase": {
        "type": "object",
        "required": [
          "discovery_type",
          "run_type",
          "name",
          "daemon_id",
          "network_id"
        ],
        "properties": {
          "daemon_id": {
            "type": "string",
            "format": "uuid"
          },
          "discovery_type": {
            "$ref": "#/components/schemas/DiscoveryType"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "run_type": {
            "$ref": "#/components/schemas/RunType"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "DiscoveryMetadata": {
        "allOf": [
          {
            "$ref": "#/components/schemas/DiscoveryType"
          },
          {
            "type": "object",
            "required": [
              "daemon_id",
              "date"
            ],
            "properties": {
              "daemon_id": {
                "type": "string",
                "format": "uuid"
              },
              "date": {
                "type": "string",
                "format": "date-time"
              }
            }
          }
        ]
      },
      "DiscoveryPhase": {
        "type": "string",
        "enum": [
          "Pending",
          "Starting",
          "Started",
          "Scanning",
          "Complete",
          "Failed",
          "Cancelled"
        ]
      },
      "DiscoveryType": {
        "oneOf": [
          {
            "type": "object",
            "title": "SelfReport",
            "required": [
              "host_id",
              "type"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "type": {
                "type": "string",
                "enum": [
                  "SelfReport"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Network",
            "required": [
              "type"
            ],
            "properties": {
              "host_naming_fallback": {
                "$ref": "#/components/schemas/HostNamingFallback"
              },
              "subnet_ids": {
                "type": [
                  "array",
                  "null"
                ],
                "items": {
                  "type": "string",
                  "format": "uuid"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "Network"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Docker",
            "required": [
              "host_id",
              "type"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "host_naming_fallback": {
                "$ref": "#/components/schemas/HostNamingFallback"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Docker"
                ]
              }
            }
          }
        ]
      },
      "DiscoveryUpdatePayload": {
        "type": "object",
        "description": "Progress update from daemon to server during discovery",
        "required": [
          "session_id",
          "daemon_id",
          "network_id",
          "phase",
          "discovery_type",
          "progress"
        ],
        "properties": {
          "daemon_id": {
            "type": "string",
            "format": "uuid"
          },
          "discovery_type": {
            "$ref": "#/components/schemas/DiscoveryType"
          },
          "error": {
            "type": [
              "string",
              "null"
            ]
          },
          "finished_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "phase": {
            "$ref": "#/components/schemas/DiscoveryPhase"
          },
          "progress": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "session_id": {
            "type": "string",
            "format": "uuid"
          },
          "started_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          }
        }
      },
      "DockerVirtualization": {
        "type": "object",
        "required": [
          "service_id"
        ],
        "properties": {
          "container_id": {
            "type": [
              "string",
              "null"
            ]
          },
          "container_name": {
            "type": [
              "string",
              "null"
            ]
          },
          "service_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "EdgeStyle": {
        "type": "string",
        "enum": [
          "Straight",
          "SmoothStep",
          "Step",
          "Bezier",
          "SimpleBezier"
        ]
      },
      "EntitySource": {
        "oneOf": [
          {
            "type": "object",
            "title": "Manual",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "Manual"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "System",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "System"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Discovery",
            "required": [
              "metadata",
              "type"
            ],
            "properties": {
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/DiscoveryMetadata"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "Discovery"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "DiscoveryWithMatch",
            "required": [
              "metadata",
              "details",
              "type"
            ],
            "properties": {
              "details": {
                "$ref": "#/components/schemas/MatchDetails"
              },
              "metadata": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/DiscoveryMetadata"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "DiscoveryWithMatch"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Unknown",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "Unknown"
                ]
              }
            }
          }
        ]
      },
      "Group": {
        "allOf": [
          {
            "$ref": "#/components/schemas/GroupBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "binding_ids": [],
          "color": "#3B82F6",
          "created_at": "2026-01-15T10:30:00Z",
          "description": "HTTP/HTTPS services group",
          "edge_style": "Bezier",
          "group_type": "RequestPath",
          "id": "550e8400-e29b-41d4-a716-446655440008",
          "name": "Web Services",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "GroupBase": {
        "type": "object",
        "required": [
          "name",
          "network_id",
          "group_type",
          "color"
        ],
        "properties": {
          "binding_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            },
            "description": "Ordered list of binding IDs for this group"
          },
          "color": {
            "type": "string"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "edge_style": {
            "$ref": "#/components/schemas/EdgeStyle"
          },
          "group_type": {
            "$ref": "#/components/schemas/GroupType"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "GroupType": {
        "type": "string",
        "enum": [
          "RequestPath",
          "HubAndSpoke"
        ]
      },
      "HostNamingFallback": {
        "type": "string",
        "enum": [
          "Ip",
          "BestService"
        ]
      },
      "HostResponse": {
        "type": "object",
        "description": "Response type for host endpoints.\nIncludes hydrated children (interfaces, ports, services).",
        "required": [
          "id",
          "created_at",
          "updated_at",
          "name",
          "network_id",
          "source",
          "hidden",
          "tags",
          "interfaces",
          "ports",
          "services"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "interfaces": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Interface"
            }
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "ports": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Port"
            }
          },
          "services": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Service"
            }
          },
          "source": {
            "$ref": "#/components/schemas/EntitySource"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        },
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Primary web server",
          "hidden": false,
          "hostname": "web-server-01.local",
          "id": "550e8400-e29b-41d4-a716-446655440003",
          "interfaces": [
            {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440005",
              "ip_address": "192.168.1.100",
              "mac_address": "DE:AD:BE:EF:12:34",
              "name": "eth0",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          ],
          "name": "web-server-01",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "ports": [
            {
              "created_at": "2026-01-15T10:30:00Z",
              "host_id": "550e8400-e29b-41d4-a716-446655440003",
              "id": "550e8400-e29b-41d4-a716-446655440006",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "number": 80,
              "protocol": "Tcp",
              "type": "Http",
              "updated_at": "2026-01-15T10:30:00Z"
            }
          ],
          "services": [],
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z",
          "virtualization": null
        }
      },
      "HostVirtualization": {
        "oneOf": [
          {
            "type": "object",
            "title": "Proxmox",
            "required": [
              "details",
              "type"
            ],
            "properties": {
              "details": {
                "$ref": "#/components/schemas/ProxmoxVirtualization"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Proxmox"
                ]
              }
            }
          }
        ],
        "title": "HostVirtualization"
      },
      "Interface": {
        "allOf": [
          {
            "$ref": "#/components/schemas/InterfaceBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "host_id": "550e8400-e29b-41d4-a716-446655440003",
          "id": "550e8400-e29b-41d4-a716-446655440005",
          "ip_address": "192.168.1.100",
          "mac_address": "DE:AD:BE:EF:12:34",
          "name": "eth0",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "subnet_id": "550e8400-e29b-41d4-a716-446655440004",
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "InterfaceBase": {
        "type": "object",
        "required": [
          "network_id",
          "host_id",
          "subnet_id",
          "ip_address"
        ],
        "properties": {
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "ip_address": {
            "type": "string"
          },
          "mac_address": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": [
              "string",
              "null"
            ]
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "subnet_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "Invite": {
        "allOf": [
          {
            "$ref": "#/components/schemas/InviteBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "InviteBase": {
        "type": "object",
        "required": [
          "organization_id",
          "permissions",
          "network_ids",
          "url",
          "created_by",
          "expires_at"
        ],
        "properties": {
          "created_by": {
            "type": "string",
            "format": "uuid"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "send_to": {
            "type": [
              "string",
              "null"
            ]
          },
          "url": {
            "type": "string"
          }
        }
      },
      "MatchConfidence": {
        "type": "string",
        "enum": [
          "NotApplicable",
          "Low",
          "Medium",
          "High",
          "Certain"
        ]
      },
      "MatchDetails": {
        "type": "object",
        "required": [
          "reason",
          "confidence"
        ],
        "properties": {
          "confidence": {
            "$ref": "#/components/schemas/MatchConfidence"
          },
          "reason": {
            "$ref": "#/components/schemas/MatchReason"
          }
        }
      },
      "MatchReason": {
        "type": "object",
        "description": "Match reason with type discriminator",
        "properties": {
          "data": {
            "type": "object"
          },
          "type": {
            "type": "object"
          }
        }
      },
      "Network": {
        "allOf": [
          {
            "$ref": "#/components/schemas/NetworkBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "id": "550e8400-e29b-41d4-a716-446655440002",
          "name": "Home Network",
          "organization_id": "550e8400-e29b-41d4-a716-446655440001",
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "NetworkBase": {
        "type": "object",
        "required": [
          "name",
          "organization_id"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "Organization": {
        "allOf": [
          {
            "$ref": "#/components/schemas/OrganizationBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "OrganizationBase": {
        "type": "object",
        "required": [
          "name",
          "onboarding"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "onboarding": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TelemetryOperation"
            }
          },
          "plan": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/BillingPlan"
              }
            ]
          },
          "plan_status": {
            "type": [
              "string",
              "null"
            ]
          },
          "stripe_customer_id": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "PlanConfig": {
        "type": "object",
        "required": [
          "base_cents",
          "rate",
          "trial_days"
        ],
        "properties": {
          "base_cents": {
            "type": "integer",
            "format": "int64"
          },
          "included_networks": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "minimum": 0
          },
          "included_seats": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "minimum": 0
          },
          "network_cents": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64"
          },
          "rate": {
            "$ref": "#/components/schemas/BillingRate"
          },
          "seat_cents": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64"
          },
          "trial_days": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          }
        }
      },
      "Port": {
        "allOf": [
          {
            "$ref": "#/components/schemas/PortBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "description": "Note: TS types for Port are defined in ts_exports due to PortType's custom serialization",
        "example": {
          "created_at": "2026-01-15T10:30:00Z",
          "host_id": "550e8400-e29b-41d4-a716-446655440003",
          "id": "550e8400-e29b-41d4-a716-446655440006",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "number": 80,
          "protocol": "Tcp",
          "type": "Http",
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "PortBase": {
        "allOf": [
          {
            "$ref": "#/components/schemas/PortType"
          },
          {
            "type": "object",
            "required": [
              "host_id",
              "network_id"
            ],
            "properties": {
              "host_id": {
                "type": "string",
                "format": "uuid"
              },
              "network_id": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        ],
        "description": "The base data for a Port entity (everything except id, created_at, updated_at)\nNote: TS types for Port are defined in ts_exports due to PortType's custom serialization"
      },
      "PortType": {
        "type": "object",
        "description": "Port type with number, protocol, and optional type identifier",
        "required": [
          "number",
          "protocol"
        ],
        "properties": {
          "number": {
            "type": "integer"
          },
          "protocol": {
            "type": "string",
            "enum": [
              "Udp",
              "Tcp"
            ]
          },
          "type": {
            "type": "string",
            "description": "Auto-derived from number+protocol; optional on create"
          }
        }
      },
      "ProxmoxVirtualization": {
        "type": "object",
        "required": [
          "service_id"
        ],
        "properties": {
          "service_id": {
            "type": "string",
            "format": "uuid"
          },
          "vm_id": {
            "type": [
              "string",
              "null"
            ]
          },
          "vm_name": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "RunType": {
        "oneOf": [
          {
            "type": "object",
            "title": "Scheduled",
            "required": [
              "cron_schedule",
              "enabled",
              "type"
            ],
            "properties": {
              "cron_schedule": {
                "type": "string"
              },
              "enabled": {
                "type": "boolean"
              },
              "last_run": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Scheduled"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "Historical",
            "required": [
              "results",
              "type"
            ],
            "properties": {
              "results": {
                "$ref": "#/components/schemas/DiscoveryUpdatePayload"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Historical"
                ]
              }
            }
          },
          {
            "type": "object",
            "title": "AdHoc",
            "required": [
              "type"
            ],
            "properties": {
              "last_run": {
                "type": [
                  "string",
                  "null"
                ],
                "format": "date-time"
              },
              "type": {
                "type": "string",
                "enum": [
                  "AdHoc"
                ]
              }
            }
          }
        ],
        "description": "Note: DiscoveryUpdatePayload field is skipped from TS export as it's only used internally"
      },
      "Service": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ServiceBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "bindings": [
            {
              "created_at": "2025-12-24T04:33:16.078615Z",
              "id": "1b924950-99cf-4774-97b5-6433ae491924",
              "interface_id": "550e8400-e29b-41d4-a716-446655440005",
              "network_id": "550e8400-e29b-41d4-a716-446655440002",
              "port_id": "550e8400-e29b-41d4-a716-446655440006",
              "service_id": "550e8400-e29b-41d4-a716-446655440007",
              "type": "Port",
              "updated_at": "2025-12-24T04:33:16.078615Z"
            }
          ],
          "created_at": "2026-01-15T10:30:00Z",
          "host_id": "550e8400-e29b-41d4-a716-446655440003",
          "id": "550e8400-e29b-41d4-a716-446655440007",
          "name": "nginx",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "service_definition": "Huntarr",
          "source": {
            "type": "Manual"
          },
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z",
          "virtualization": null
        }
      },
      "ServiceBase": {
        "type": "object",
        "required": [
          "host_id",
          "network_id",
          "service_definition",
          "name",
          "bindings"
        ],
        "properties": {
          "bindings": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Binding"
            }
          },
          "host_id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "service_definition": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/ServiceVirtualization"
              }
            ]
          }
        }
      },
      "ServiceVirtualization": {
        "oneOf": [
          {
            "type": "object",
            "title": "Docker",
            "required": [
              "details",
              "type"
            ],
            "properties": {
              "details": {
                "$ref": "#/components/schemas/DockerVirtualization"
              },
              "type": {
                "type": "string",
                "enum": [
                  "Docker"
                ]
              }
            }
          }
        ],
        "title": "ServiceVirtualization"
      },
      "Subnet": {
        "allOf": [
          {
            "$ref": "#/components/schemas/SubnetBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "cidr": "192.168.1.0/24",
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Local area network",
          "id": "550e8400-e29b-41d4-a716-446655440004",
          "name": "LAN",
          "network_id": "550e8400-e29b-41d4-a716-446655440002",
          "source": {
            "type": "Manual"
          },
          "subnet_type": "Lan",
          "tags": [],
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "SubnetBase": {
        "type": "object",
        "required": [
          "cidr",
          "network_id",
          "name",
          "subnet_type"
        ],
        "properties": {
          "cidr": {
            "type": "string"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "network_id": {
            "type": "string",
            "format": "uuid"
          },
          "subnet_type": {
            "$ref": "#/components/schemas/SubnetType"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          }
        }
      },
      "SubnetType": {
        "type": "string",
        "enum": [
          "Internet",
          "Remote",
          "Gateway",
          "VpnTunnel",
          "Dmz",
          "Lan",
          "WiFi",
          "IoT",
          "Guest",
          "DockerBridge",
          "Management",
          "Storage",
          "Unknown",
          "None"
        ]
      },
      "Tag": {
        "allOf": [
          {
            "$ref": "#/components/schemas/TagBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ],
        "example": {
          "color": "#22C55E",
          "created_at": "2026-01-15T10:30:00Z",
          "description": "Production environment resources",
          "id": "550e8400-e29b-41d4-a716-44665544000a",
          "name": "production",
          "organization_id": "550e8400-e29b-41d4-a716-446655440001",
          "updated_at": "2026-01-15T10:30:00Z"
        }
      },
      "TagBase": {
        "type": "object",
        "required": [
          "name",
          "color",
          "organization_id"
        ],
        "properties": {
          "color": {
            "type": "string"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "name": {
            "type": "string"
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "TelemetryOperation": {
        "type": "string",
        "enum": [
          "OrgCreated",
          "OnboardingModalCompleted",
          "PersonalPlanSelected",
          "CommercialPlanSelected",
          "FirstApiKeyCreated",
          "FirstDaemonRegistered",
          "FirstTopologyRebuild"
        ]
      },
      "TransportProtocol": {
        "type": "string",
        "enum": [
          "Udp",
          "Tcp"
        ]
      },
      "UpdateHostRequest": {
        "type": "object",
        "description": "Request type for updating a host.\nChildren (interfaces, ports, services) are managed via their own endpoints.",
        "required": [
          "id",
          "name",
          "hidden"
        ],
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "hidden": {
            "type": "boolean"
          },
          "hostname": {
            "type": [
              "string",
              "null"
            ]
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "name": {
            "type": "string"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "virtualization": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/HostVirtualization"
              }
            ]
          }
        }
      },
      "User": {
        "allOf": [
          {
            "$ref": "#/components/schemas/UserBase"
          },
          {
            "type": "object",
            "properties": {
              "created_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              },
              "id": {
                "type": "string",
                "format": "uuid",
                "readOnly": true
              },
              "updated_at": {
                "type": "string",
                "format": "date-time",
                "readOnly": true
              }
            }
          }
        ]
      },
      "UserBase": {
        "type": "object",
        "required": [
          "email",
          "organization_id",
          "permissions"
        ],
        "properties": {
          "email": {
            "type": "string"
          },
          "network_ids": {
            "type": "array",
            "items": {
              "type": "string",
              "format": "uuid"
            }
          },
          "oidc_linked_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          },
          "oidc_provider": {
            "type": [
              "string",
              "null"
            ]
          },
          "oidc_subject": {
            "type": [
              "string",
              "null"
            ]
          },
          "organization_id": {
            "type": "string",
            "format": "uuid"
          },
          "permissions": {
            "$ref": "#/components/schemas/UserOrgPermissions"
          },
          "terms_accepted_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time"
          }
        }
      },
      "UserOrgPermissions": {
        "type": "string",
        "enum": [
          "Owner",
          "Admin",
          "Member",
          "Viewer"
        ]
      }
    },
    "securitySchemes": {
      "api_key": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key",
        "description": "API key for daemon authentication. Generate keys in the web UI under Settings > API Keys."
      },
      "session": {
        "type": "apiKey",
        "in": "cookie",
        "name": "session"
      }
    }
  }
}